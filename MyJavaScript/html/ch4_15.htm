<html>
<head>
 <title>ѧ��ɼ�����ϵͳ</title>
<script language = "JavaScript" >
<!--
  var emails = new Object();
  emails["001"]="zxs@hotmail.com"
  emails["002"]="lxs@yahoo.com"
  emails["003"]="cxx@gmail.com"
  emails["004"]="wbb@hotmail.com"
  var errMsg = "";

  function doSelect() {
    var selected = document.mainForm.nameList.selectedIndex;
	  var selectedValue = document.mainForm.nameList.options[selected].value;
	  var selectedText = document.mainForm.nameList.options[selected].text;
    document.images["studentImage"].src = selectedValue + ".gif";
    document.links[0].href="emailto:"+emails[selectedValue];
    document.title = "ѧ��ɼ�����ϵͳ - " + selectedText
  }
  function clearAll() {
   document.mainForm.nameList.selectedIndex=-1;
   document.mainForm.chinese.value="";
   document.mainForm.math.value="";
   document.mainForm.optSubject[0].click();
   document.mainForm.another.value="";
   document.mainForm.gym.value="";
  }
  function checkRequired(form, name,label) {
   if (form[name].value=="")
     errMsg += '������"'+label+'"\n';
	}
	function isScore(s) {
	  for (var i = 0; i < s.length; i++){
      var c = s.charAt(i);
      if (((c < "0") || (c > "9"))) return false;
	  }
	  if (parseInt(s)>100) return false;
	  return true;
	}
	function checkScore(form,name,label) {
	  if (form[name].value.length>0 && !isScore(form[name].value))
      errMsg += '����"'+label+'"��Ч\n';
	}
	function checkGym() {
	  var gymScore = document.mainForm["gym"].value;
	  var isValidString = true;
	  if (gymScore.length>0) {
	  	if (gymScore.length!=1) isValidString = false;
		  var validChars = "abcdef";
		  var c = gymScore.toLowerCase();
      if (validChars.indexOf(c) == -1)
		       isValidString = false;
	  }
	  if (!isValidString)
      errMsg += '����"����"��Ч\n';
	}
  function doSubmit() {
    var form = document.mainForm;
    checkRequired(form,"nameList","ѧ������");
    checkRequired(form,"chinese","����");
    checkScore(form,"chinese","����");
    checkRequired(form,"math","��ѧ");
    checkScore(form,"math","��ѧ");
    checkRequired(form,"another","��ʷ��ʶ");
    checkScore(form,"another","��ʷ��ʶ");
    checkRequired(form,"gym","����");
    checkGym();
    if (errMsg.length>0) {
    	alert(errMsg);
    	errMsg="";
    	return false;
    }
    else 
     document.mainForm.submit();
    
  }
 //-->
 </script>
</head>
<body onload="clearAll();">
<b>ѧ��ɼ�����ϵͳ</b>
<form name="mainForm">
<table style="font-size:14px;">
��<tr><td colspan="2">ѧ����</td></tr>
  <tr>
    <td>
      <select name="nameList" size="6" style="width:100px" onchange="doSelect();">
        <option value="001">��Сɽ</option>
        <option value="002">��Сʯ</option>
        <option value="003">������</option>
        <option value="004">������</option>
      </select>
    </td>
    <td>
      <img src="blank.gif" name="studentImage">
    </td>
  </tr>
  <tr>
    <td>��ϵ��ʽ:</td>
    <td><a href="#" name="email">�����ʼ�</a></td>
  </tr>
  <tr>
    <td>����:</td>
    <td><input type="text" name="chinese"></td>
  </tr>
  <tr>
    <td>��ѧ:</td>
    <td><input type="text" name="math"></td>
  </tr>
  <tr>
    <td><input type="radio" name="optSubject" checked>��ʷ:<br>
<input type="radio" name="optSubject">��ʶ:
    </td>
    <td><input type="text" name="another"></td>
  </tr>
  <tr>
    <td>����:</td>
    <td><input type="text" name="gym"></td>
  </tr>
  <tr>
    <td><input type="button" value=" �ύ " onclick="doSubmit();"></td>
    <td>&nbsp</td>
  </tr>
</table>
</form>
</body>
</html>
